import{y as e,n as a,P as t,r as l,o as s,d as i,w as d,c as o,i as n,e as r,h as u,v,p as c,j as p,q as m,f,g as y,F as b,t as k,R as g,Q as _,S as x,D as h}from"./index-om00KmGp.js";import{u as w}from"./useFormState-BETjqvZH.js";import{s as T,g as I,l as C,a as S,e as U}from"./extProp-Bnn8Zgpt.js";import{_ as j}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{S as F}from"./sortable.esm-CG_H93Kl.js";import{D as O}from"./DragOutlined-CEbZ_41v.js";const D=(e=>(c("data-v-bbdf0ee4"),e=e(),p(),e))((()=>n("div",{class:"title"},"扩展词条信息",-1))),q={class:"grid grid-cols-2 gap-0"},N=j({__name:"addWordModal",props:{id:{type:String,default:void 0},visible:{type:Boolean,default:!1}},emits:["update:visible","afterSave"],setup(c,{emit:p}){const m=c,f=p,y=e({get:()=>m.visible,set(e){f("update:visible",e)}}),b=a(null),k=a({name:[{required:!0,message:"请输入名称",trigger:"blur"}],propType:[{required:!0,message:"请选择词条类型",trigger:"blur"}],length:[{required:!0,message:"请输入长度",trigger:"blur"}]}),g=()=>{b.value.validate().then((async(e,a)=>{if(!e)return b.value.focusFirstField(),!1;{const e=await T(x),{code:a}=e;a||(v.success("保存成功"),f("afterSave"),_())}})).catch((e=>{}))},_=()=>{C(),y.value=!1},{formState:x,patchFormState:h,resetFormState:C}=w({id:void 0,name:void 0,length:void 0,propType:void 0,remark:void 0,type:2});return t((()=>m.id),(async e=>{if(e){const a=await I({id:e}),{code:t,data:l}=a;t||h(l)}})),(e,a)=>{const t=l("a-input"),v=l("a-form-item"),p=l("a-select-option"),m=l("a-select"),f=l("a-textarea"),h=l("a-form"),w=l("a-modal");return s(),i(w,{visible:y.value,"onUpdate:visible":a[4]||(a[4]=e=>y.value=e),title:""+(c.id?"修改扩展词条":"新增扩展词条"),onOk:g,onCancel:_,okText:"保存",width:"60%",destroyOnClose:!0,maskClosable:!1},{default:d((()=>[o(h,{ref_key:"wordForm",ref:b,model:r(x),name:"extendWord","label-col":{style:{width:"80px"}},"wrapper-col":{span:16},autocomplete:"off",rules:k.value},{default:d((()=>[D,n("div",q,[o(v,{label:"名称",name:"name"},{default:d((()=>[o(t,{value:r(x).name,"onUpdate:value":a[0]||(a[0]=e=>r(x).name=e)},null,8,["value"])])),_:1}),o(v,{label:"词条类型",name:"propType"},{default:d((()=>[o(m,{label:"词条类型",placeholder:"请选择",value:r(x).propType,"onUpdate:value":a[1]||(a[1]=e=>r(x).propType=e),allowClear:""},{default:d((()=>[o(p,{value:1},{default:d((()=>[u("数字")])),_:1}),o(p,{value:2},{default:d((()=>[u("文本")])),_:1}),o(p,{value:3},{default:d((()=>[u("日期")])),_:1})])),_:1},8,["value"])])),_:1}),o(v,{label:"长度",name:"length"},{default:d((()=>[o(t,{value:r(x).length,"onUpdate:value":a[2]||(a[2]=e=>r(x).length=e)},null,8,["value"])])),_:1}),o(v,{label:"词条说明",name:"remark"},{default:d((()=>[o(f,{type:"textarea",value:r(x).remark,"onUpdate:value":a[3]||(a[3]=e=>r(x).remark=e)},null,8,["value"])])),_:1})])])),_:1},8,["model","rules"])])),_:1},8,["visible","title"])}}},[["__scopeId","data-v-bbdf0ee4"]]),R={class:"sort-name"},A=j({__name:"sortWordModel",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","afterSave"],setup(u,{emit:c}){const p=u,_=c,x=e({get:()=>p.visible,set(e){_("update:visible",e)}}),h=a([]),w=async()=>{const{data:e}=await C({status:1,type:2});h.value=e||[]},T=a(),I=async()=>{let e=h.value.map((e=>e.id));const a=await S({ids:e}),{code:t}=a;t||(v.success("保存成功"),_("afterSave"),U())},U=()=>{x.value=!1};return t((()=>p.visible),(async e=>{e&&(g((()=>{F.create(T.value,{animation:200,group:"name",sort:!0,onEnd:({newIndex:e,oldIndex:a})=>{if(e!==a){const t=h.value.splice(a,1)[0];h.value.splice(e,0,t)}}})})),w())})),m((()=>{w()})),(e,a)=>{const t=l("a-modal");return s(),i(t,{visible:x.value,"onUpdate:visible":a[0]||(a[0]=e=>x.value=e),title:"移动扩展词条",onOk:I,onCancel:U,okText:"保存",width:"40%",destroyOnClose:!0,maskClosable:!1},{default:d((()=>[n("div",{id:"container",class:"sortable-box",ref_key:"sortableBox",ref:T},[(s(!0),f(b,null,y(h.value,(e=>(s(),f("div",{class:"sort-item",key:e.id},[o(r(O)),n("span",R,k(e.name),1)])))),128))],512)])),_:1},8,["visible"])}}},[["__scopeId","data-v-74755d1f"]]),B={__name:"index",setup(e){const n=a([]),r=a(!1);a();const c=a(1),p=e=>{c.value=e,y()},y=async()=>{r.value=!0;const e=await C({type:2,status:c.value}),{code:a,data:t}=e;a||(n.value=t,r.value=!1)},k=a(null),g=a(!1),w=()=>{g.value=!0},T=a(!1),I=()=>{T.value=!0};t(g,(e=>{e||(k.value=null)}));const S=[{title:"词条名称",dataIndex:"name",key:"name"},{title:"词条类型",dataIndex:"propType",key:"propType",customRender:e=>2===e.value?"文本":1===e.value?"数字":3===e.value?"日期":void 0},{title:"词条长度",dataIndex:"length",key:"length"},{title:"状态",dataIndex:"status",key:"status",customRender:e=>o(x,{checked:e.value,onChange:async a=>{h.confirm({title:"提示",content:"确定要"+(a?"启用":"禁用")+"该扩展词吗？",onOk:async()=>{(await U({ids:[e.record.id],status:a?1:0})).code||(v.success("操作成功"),e.record.status=a?1:0,h.destroyAll(),y())}})},checkedValue:1,unCheckedValue:0,disabled:0===e.record.id},null)},{title:"词条说明",dataIndex:"remark",key:"remark"},{title:"创建人",dataIndex:"createUserName",key:"createUserName"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"修改人",dataIndex:"updateUserName",key:"updateUserName"},{title:"修改时间",dataIndex:"updateTime",key:"updateTime"},{title:"操作",dataIndex:"action",key:"action",customRender:e=>o("div",{class:"flex flex-row gap-2"},[o(l("a-button"),{type:"link",size:"small",onClick:()=>(({record:e})=>{k.value=e.id,g.value=!0})(e)},{default:()=>[u("编辑")]})])}];return m((()=>{c.value=1,y()})),(e,a)=>{const t=l("a-tab-pane"),v=l("a-tabs"),m=l("a-button");return s(),f(b,null,[o(_,{columns:S,tableData:n.value,loading:r.value},{tableTitle:d((()=>[o(v,{activeKey:c.value,"onUpdate:activeKey":a[0]||(a[0]=e=>c.value=e),onChange:p},{default:d((()=>[(s(),i(t,{key:1,tab:"启用中"})),(s(),i(t,{key:0,tab:"已停用"}))])),_:1},8,["activeKey"])])),actions:d((()=>[o(m,{type:"primary",onClick:I},{default:d((()=>[u("移动扩展词条")])),_:1}),o(m,{type:"primary",onClick:w},{default:d((()=>[u("新增扩展词条")])),_:1})])),_:1},8,["tableData","loading"]),o(N,{visible:g.value,"onUpdate:visible":a[1]||(a[1]=e=>g.value=e),onAfterSave:y,id:k.value},null,8,["visible","id"]),o(A,{visible:T.value,"onUpdate:visible":a[2]||(a[2]=e=>T.value=e),onAfterSave:y},null,8,["visible"])],64)}}};export{B as default};
