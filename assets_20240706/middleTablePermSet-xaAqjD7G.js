import{n as e,y as a,q as t,r as l,o as d,f as i,i as n,F as s,g as c,c as o,w as r,h as u,d as h,A as m,t as v,D as k,G as x,H as g,J as p,v as y,L as b,C as f,e as w}from"./index-DlcaZKbg.js";import{l as C}from"./user-CxSvkcge.js";import{d as I,R as _}from"./RightOutlined-xi13VRMi.js";const z={class:"h-full flex flex-row p-4"},N={class:"w-1/3 border-r p-2 pt-0 overflow-auto bg-white"},j=n("div",{class:"common-title-small mb-4 pt-2 sticky top-0 bg-white"}," 在用用户列表 ",-1),T=["onClick"],U={class:"w-full flex items-center"},O={class:"text-xs text-gray-500 ml-auto mr-4"},R={class:"text-xs text-gray-500 mr-4"},q={class:"p-2 pt-0 overflow-auto w-2/3 bg-white"},A={class:"common-title-small mb-4 pt-2 flex sticky top-0 bg-white z-10"},D=n("div",null,"中间表列表",-1),E={__name:"middleTablePermSet",setup(E){const F=e([]),G=e(void 0),H=(e,a=!1)=>{!a&&S.value?k.confirm({title:"提示",content:"此操作会丢失当前内容，是否继续？",okText:"继续",cancelText:"取消",onOk:()=>{G.value=e.id,B(e.id)}}):(G.value=e.id,B(e.id))};let J=[],L=[];const P=e([]),S=a((()=>I(L,V.value).length>0||I(V.value,L).length>0)),V=e([]),W=a((()=>V.value.length===J.length&&J.length>0));a((()=>!W.value&&V.value.length>0));const B=async e=>{if(void 0===e)return;V.value=[],J=[],L=[];const a=await x({roleId:e}),{code:t,data:l}=a;t||(P.value=l,K(l),L=g(V.value))},K=e=>{e.forEach((e=>{J.push(e.id),e.selected&&V.value.push(e.id),e.children&&e.children.length&&K(e.children)}))},M=async()=>{const e=await p({roleId:G.value,menuIds:V.value}),{code:a,data:t}=e;a||(B(G.value),y.success("保存成功"))},Q=()=>{V.value=g(L)};t((()=>{(async e=>{const a=await C({status:1}),{code:t,data:l}=a;t||(F.value=l,H(null==l?void 0:l[0],!0))})()}));const X=[{title:"序号",dataIndex:"index",key:"index",width:60,align:"center"},{title:"表名称",dataIndex:"tableName",key:"tableName",width:200,align:"center"},{title:"",dataIndex:"view",key:"view",width:80,align:"center"},{title:"查看",dataIndex:"detail",key:"detail",width:100,align:"center"},{title:"编辑",dataIndex:"edit",key:"edit",width:100,align:"center"},{title:"启/停用",dataIndex:"start",key:"start",width:100,align:"center"}];return(e,a)=>{const t=l("a-button"),k=l("a-checkbox"),x=l("a-table");return d(),i("div",z,[n("div",N,[j,n("div",null,[(d(!0),i(s,null,c(F.value,(e=>(d(),i("div",{key:e.id,onClick:a=>H(e),class:b(["mb-2 w-full h-8 cursor-pointer hover:bg-gray-100 flex flex-row items-center px-2 py-1 transition-all duration-300",G.value===e.id?"bg-gray-100":""])},[n("div",U,[n("span",null,"账号："+v(e.account),1),n("span",O," 姓名："+v(e.name||"--"),1),n("span",R," 手机号："+v(e.mobile||"--"),1)]),o(w(_),{class:"ml-auto",style:f({"font-size":"smaller",visibility:G.value===e.id?"visible":"hidden"})},null,8,["style"])],10,T)))),128))])]),n("div",q,[n("div",A,[D,o(t,{size:"small",class:"ml-auto",disabled:!S.value,onClick:Q},{default:r((()=>[u("重置")])),_:1},8,["disabled"]),o(t,{size:"small",type:"primary",class:"ml-2 mr-6",disabled:!S.value,onClick:M},{default:r((()=>[u("保存")])),_:1},8,["disabled"])]),o(x,{columns:X,"data-source":[{tableName:"12"}],pagination:!1,size:"small"},{headerCell:r((({title:t,column:l})=>["detail"===l.dataIndex?(d(),h(k,{key:0,checked:e.record,"onUpdate:checked":a[0]||(a[0]=a=>e.record=a),indeterminate:e.record,onChange:a[1]||(a[1]=a=>e.onCheckChange(e.record))},{default:r((()=>[u(" 查看 ")])),_:1},8,["checked","indeterminate"])):m("",!0)])),bodyCell:r((({column:a,record:l,index:n})=>["index"===a.dataIndex?(d(),i(s,{key:0},[u(v(n+1),1)],64)):m("",!0),"detail"===a.dataIndex?(d(),h(k,{key:1,checked:l.checked,"onUpdate:checked":e=>l.checked=e,onChange:a=>e.onCheckChange(l)},{default:r((()=>[u(v(l.menuName),1)])),_:2},1032,["checked","onUpdate:checked","onChange"])):m("",!0),"view"===a.dataIndex?(d(),h(t,{key:2,type:"link"},{default:r((()=>[u("预览")])),_:1})):m("",!0)])),_:1})])])}}};export{E as default};
